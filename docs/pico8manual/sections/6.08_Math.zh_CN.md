## 6.8 数学

------------

##### MAX(X, Y)

##### MIN(X, Y)

##### MID(X, Y, Z)

返回参数的最大值、最小值或中间值

```
> ?MID(7,5,10) -- 7  
```
  
##### FLR(X)

```
> ?FLR ( 4.1) -->  4  
> ?FLR (-2.3) --> -3  
```
  
##### CEIL(X)

返回大于或等于 x 的最接近的整数

```
> ?CEIL( 4.1) -->  5  
> ?CEIL(-2.3) --> -2  
```
  
##### COS(X)

##### SIN(X)

返回 x 的余弦或正弦值，其中 1.0 表示一个完整的旋转。例如，要制作一个每秒旋转一圈的指针：

```
FUNCTION _DRAW()  
  CLS()  
  CIRC(64, 64, 20, 7)  
  X = 64 + COS(T()) \* 20  
  Y = 64 + SIN(T()) \* 20  
  LINE(64, 64, X, Y)  
END
```  

PICO-8 的 SIN() 返回一个反转的结果以适应屏幕空间（其中 Y 表示“向下”，而数学图中 Y 通常表示“向上”）。

```
> SIN(0.25) -- 返回 -1  
```

为了获得基于弧度的常规三角函数（不带 Y 轴反转），请将以下代码片段粘贴到程序的开头附近：

```
P8COS = COS FUNCTION COS(ANGLE) RETURN P8COS(ANGLE/(3.1415\*2)) END  
P8SIN = SIN FUNCTION SIN(ANGLE) RETURN -P8SIN(ANGLE/(3.1415\*2)) END  
```

  
##### ATAN2(DX, DY)

将 DX, DY 转换为 0..1 之间的角度

与 cos/sin 类似，角度在屏幕空间中逆时针运行。例如：

```
> ?ATAN(0, -1) -- 返回 0.25  
```

ATAN2 可以用于查找两个点之间的方向：

```
X=20 Y=30  
FUNCTION _UPDATE()  
  IF (BTN(0)) X-=2  
  IF (BTN(1)) X+=2  
  IF (BTN(2)) Y-=2  
  IF (BTN(3)) Y+=2  
END

  FUNCTION _DRAW()  
  CLS()  
  CIRCFILL(X,Y,2,14)  
  CIRCFILL(64,64,2,7)

      A=ATAN2(X-64, Y-64)  
  PRINT("角度: "..A)  
  LINE(64,64,  
    64+COS(A)\*10,  
    64+SIN(A)\*10,7)  
END
```
  
##### SQRT(X)

返回 x 的平方根

  
##### ABS(X)

返回 x 的绝对（正值）值

  
##### RND(X)

返回一个随机数 n，其中 0 <= n < x

如果需要整数，使用 flr(rnd(x))。如果 x 是一个数组样式的表，返回一个介于 table\[1\] 和 table\[#table\] 之间的随机元素。

  
##### SRAND(X)

设置随机数种子。种子在卡带启动时会自动随机化。

```
FUNCTION _DRAW()  
  CLS()  
  SRAND(33)  
  FOR I=1,100 DO  
    PSET(RND(128),RND(128),7)  
  END  
END  
```

#### ■ 位运算

位运算类似于逻辑表达式，不同之处在于它们在位级别上工作。

假设你有两个数字（使用二进制前缀 "0b" 写出）：

```
X = 0b1010  
Y = 0b0110  
```

一个按位 AND 操作会在 X 和 Y 的相应位都设置时给出结果

```
> PRINT(BAND(X,Y)) -- 结果:0B0010 (2 以十进制表示)  
```

PICO-8 中有 9 个按位函数可用：

```
BAND(X, Y) -- 两个位都设置  
BOR(X, Y)  -- 任一位设置  
BXOR(X, Y) -- 任一位设置，但不是两者都设置  
BNOT(X)    -- 每个位未设置  
SHL(X, N)  -- 左移 N 位（右侧填零）  
SHR(X, N)  -- 算术右移（左侧的位状态被复制）  
LSHR(X, N) -- 逻辑右移（左侧填零）  
ROTL(X, N) -- 将 X 中的所有位向左旋转 N 位  
ROTR(X, N) -- 将 X 中的所有位向右旋转 N 位  
```

还提供了运算符版本：& | ^^ ~ << >> >>> <<> >><

例如：PRINT(67 & 63) -- 结果:3 等价于 BAND(67,63)

运算符比它们对应的函数稍快。它们的行为完全相同，除了如果任何操作数不是数字，结果将是一个运行时错误（函数版本则默认为 0）。


#### ■ 整数除法

整数除法可以使用 \\

```
> PRINT(9\\2) -- 结果:4  等价于 FLR(9/2)  
```
